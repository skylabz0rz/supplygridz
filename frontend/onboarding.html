<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SBA Form 302-B - Startup Business Administration</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="dashboard.css">
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    body {
      background: linear-gradient(to bottom, #fdfdfd 90%, #cce0ff 10%) repeat;
      font-family: "Courier New", Courier, monospace;
    }
    #map { height: 300px; margin-top: 15px; }
    .step { display: none; }
    .step.active { display: block; }
    .form-group { margin-bottom: 12px; }
    .logo-grid img { width: 100px; margin-right: 10px; border: 2px solid transparent; cursor: pointer; }
    .logo-grid img.selected { border-color: #eb5424; }
    .faux-form-title { font-family: serif; font-weight: bold; font-size: 1.4rem; margin-bottom: 8px; text-align: center; border-bottom: 3px double #000; padding-bottom: 5px; }
    .label { font-variant: small-caps; font-weight: bold; display: block; margin-top: 10px; color: #0b5394; }
    .gridline-box { border: 2px solid #0074D9; padding: 20px; margin-top: 10px; background: white; }
    .highlight { background: #ffffaa; border: 1px dashed #999; padding: 4px; }
    .legal-note { font-style: italic; font-size: 0.8rem; color: #555; margin-top: 10px; text-align: center; }
    #sidebar ul li { color: #999; }
    #sidebar ul li.active { color: #000; font-weight: bold; }
    .step-nav { text-align: center; margin-top: 24px; }
  </style>
</head>
<body>
  <div id="dashboard-container">
    <aside id="sidebar">
      <div class="brand">SupplyGridz</div>
      <nav>
        <ul>
          <li id="nav-step-1" class="active">üìÑ SBA Loan Form 302-B</li>
          <li id="nav-step-2">üè¢ SBA Form 8825-A: Company Setup</li>
          <li id="nav-step-3">üìç SBA Form 2031-HQ: HQ Placement</li>
        </ul>
      </nav>
    </aside>

    <main id="main">
      <header id="topbar">
        <div class="title" id="application-id">Startup Business Administration - Application ID: Generating...</div>
      </header>

      <section id="content">
        <div class="card gridline-box">
          <!-- STEP 1 -->
          <div class="faux-form-title">SBA FORM 302-B ‚Äì LOAN REQUEST & IDENTITY DISCLOSURE</div>
          <div id="step-1" class="step active">
  <div class="form-group">
    <label class="label">In-Game Name:</label>
    <input type="text" id="playerName" class="highlight" />
  </div>
  
  
  <div class="form-group">
    <label class="label">City:</label>
    <input type="text" id="playerCity" class="highlight" />
  </div>
  <div class="form-group">
    <label class="label">State:</label>
    <input type="text" id="playerState" class="highlight" />
  </div>
  
  <hr>
  <div class="form-group">
    <label class="label">Loan Amount Requested:</label>
    <select id="loanAmount" class="highlight">
      <option value="50000">$50,000</option>
      <option value="150000">$150,000</option>
      <option value="300000">$300,000</option>
    </select>
  </div>
  <div class="form-group">
    <label class="label">Loan Term:</label>
    <select id="loanTerm" class="highlight">
      <option value="1">1 Year</option>
      <option value="5">5 Years</option>
      <option value="10">10 Years</option>
    </select>
  </div>
  <div class="form-group">
    <label class="label">Payment Frequency:</label>
    <select id="loanFreq" class="highlight">
      <option value="daily">Daily</option>
      <option value="weekly">Weekly</option>
      <option value="monthly">Monthly</option>
    </select>
  </div>
  <div class="form-group">
    <label class="label">Estimated Interest Rate:</label>
    <input type="text" id="interestRate" readonly />
  </div>
  <div class="form-group">
    <label class="label">Projected Payment:</label>
    <input type="text" id="projectedPayment" readonly />
  </div>
</div>
            
            
            <div class="form-group">
              <label class="label">City:</label>
              <input type="text" id="playerCity" class="highlight" />
            </div>
            <div class="form-group">
              <label class="label">State:</label>
              <input type="text" id="playerState" class="highlight" />
            </div>
            
          </div>

          <!-- STEP 2 -->
          <div class="faux-form-title">SBA FORM 8825-A ‚Äì BUSINESS REGISTRATION DECLARATION</div>
          <div id="step-2" class="step">
            <div class="form-group">
              <label class="label">Company Name:</label>
              <input type="text" id="companyName" class="highlight" />
            </div>
            <div class="form-group">
              <label class="label">Fictional EIN Number:</label>
              <input type="text" id="companyEIN" class="highlight" readonly />
            </div>
            <div class="form-group">
              <label class="label">Business Structure:</label>
              <select id="companyStructure" class="highlight">
                <option>LLC</option>
                <option>Corporation</option>
                <option>Sole Proprietor</option>
                <option>Partnership</option>
              </select>
            </div>
            <div class="form-group">
              <label class="label">Business Category:</label>
              <select id="companyCategory" class="highlight">
                <option>Trucking</option>
                <option>Rail Logistics</option>
                <option>Air Freight</option>
                <option>Maritime Shipping</option>
              </select>
            </div>
            <div class="form-group">
              <label class="label">Authorized Representative Signature:</label>
              <input type="text" class="highlight" value="Digitally signed by applicant" disabled />
            </div>
          </div>

          <!-- STEP 3 -->
          <div class="faux-form-title">SBA FORM 2031-HQ ‚Äì PRIMARY TERMINAL DECLARATION</div>
          <div id="step-3" class="step">
  <div class="faux-form-title">SBA FORM 2031-HQ ‚Äì PRIMARY TERMINAL DECLARATION</div>
  <p><strong>Headquarters Lease Selection:</strong> Based on your declared city, the SBA has found the following commercial properties available for lease:</p>
  <div id="hqListings">
    <p>Searching available facilities in your city...</p>
  </div>
  <div class="form-group">
    <label class="label">Your Selection:</label>
    <input type="text" id="selectedHQ" class="highlight" readonly />
  </div>
  <div class="form-group">
    <label class="label">Certification:</label>
    <input type="text" class="highlight" value="Lease selected and reviewed by applicant" disabled />
  </div>
  <div class="form-group" style="text-align: center; margin-top: 20px;">
    <button onclick="prevStep()">‚¨Ö Back</button>
    <button id="submitBtn" onclick="submitOnboarding()">Submit Application ‚úÖ</button>
  </div>
  <div class="legal-note">SBA Form 2031-HQ requires proper lease assignment prior to operational approval. Virtual tenancy verified via grid overlay standards.</div>
</div>
            </div>
            
            <div class="form-group">
              <label class="label">Certification:</label>
              <input type="text" class="highlight" value="Map validated by field inspector" disabled />
            </div>
          </div>

          <!-- Navigation Buttons -->
          <div class="step-nav">
  <button onclick="prevStep()">‚¨Ö Back</button>
  <button id="nextBtn" onclick="nextStep()">Next ‚û°</button>
  <button id="submitBtn" style="display: none;" onclick="submitOnboarding()">Submit Application ‚úÖ</button>
</div>
        </div>
      </section>
    </main>
  </div>

  <script>
    let currentStep = 1;

    function updateSidebar(step) {
      for (let i = 1; i <= 3; i++) {
        const item = document.getElementById(`nav-step-${i}`);
        if (item) item.className = (i === step) ? 'active' : '';
      }
    }

    function nextStep() {
      document.getElementById(`step-${currentStep}`).classList.remove('active');
      currentStep++;
      document.getElementById(`step-${currentStep}`).classList.add('active');
      updateSidebar(currentStep);

      if (currentStep === 2) {
        const ein = `${Math.floor(Math.random()*90+10)}-${Math.floor(100000000+Math.random()*899999999)}`;
        document.getElementById('companyEIN').value = ein;
      }
      if (currentStep === 3) {
        initMap();
        document.getElementById('nextBtn').style.display = 'none';
        document.getElementById('submitBtn').style.display = 'inline-block';
      }
    }

    function prevStep() {
      document.getElementById(`step-${currentStep}`).classList.remove('active');
      currentStep--;
      document.getElementById(`step-${currentStep}`).classList.add('active');
      updateSidebar(currentStep);

      if (currentStep < 3) {
        document.getElementById('nextBtn').style.display = 'inline-block';
        document.getElementById('submitBtn').style.display = 'none';
      }
    }

    function initMap() {
      const lat = window.generatedLat || 39.5;
      const lng = window.generatedLng || -98.35;
      const map = L.map('map').setView([lat, lng], 6);

      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
      }).addTo(map);

      const hqMarker = L.marker([lat, lng], { draggable: true })
        .addTo(map)
        .bindPopup("Drag to set HQ location")
        .openPopup();

      updateCoords(hqMarker);
      hqMarker.on('dragend', () => updateCoords(hqMarker));
    }

    function updateCoords(marker) {
      const latlng = marker.getLatLng();
      document.getElementById('hqCoordinates').value = `${latlng.lat.toFixed(5)}, ${latlng.lng.toFixed(5)}`;
    }
  document.getElementById('loanAmount').addEventListener('change', updateInterest);
    document.getElementById('loanTerm').addEventListener('change', updateInterest);

    function updateInterest() {
  const amount = parseInt(document.getElementById('loanAmount').value);
  const term = parseInt(document.getElementById('loanTerm').value);
  const baseRate = (Math.random() * (6 - 4) + 4).toFixed(2);
  document.getElementById('interestRate').value = baseRate + '%';
  const payment = ((amount * (1 + (baseRate / 100))) / (term * 12)).toFixed(2);
  document.getElementById('projectedPayment').value = `$${payment} / mo`;
} / mo`;
    }
  function fetchHQOptions() {
  const city = document.getElementById('playerCity').value;
  const container = document.getElementById('hqListings');
  if (!city || !container) return;

  // Simulate API pull with mock commercial listings
  const mockResults = [
    `${Math.floor(Math.random()*900+100)} Commerce Ave, ${city} ‚Äì $3,200/mo`,
    `${Math.floor(Math.random()*900+100)} Freight Blvd, ${city} ‚Äì $2,750/mo`,
    `${Math.floor(Math.random()*900+100)} Industrial Loop, ${city} ‚Äì $3,450/mo`
  ];

  container.innerHTML = mockResults.map(addr => 
    `<div class="hq-option" onclick="selectHQOption(this)">${addr}</div>`
  ).join('');
}

function selectHQOption(elem) {
  document.querySelectorAll('.hq-option').forEach(opt => opt.classList.remove('selected'));
  elem.classList.add('selected');
  document.getElementById('selectedHQ').value = elem.textContent;
}

// Inject after map removal
function nextStep() {
  document.getElementById(`step-${currentStep}`).classList.remove('active');
  currentStep++;
  document.getElementById(`step-${currentStep}`).classList.add('active');
  updateSidebar(currentStep);

  if (currentStep === 2) {
    const ein = `${Math.floor(Math.random()*90+10)}-${Math.floor(100000000+Math.random()*899999999)}`;
    document.getElementById('companyEIN').value = ein;
  }
  if (currentStep === 3) {
    document.getElementById('nextBtn').style.display = 'none';
    document.getElementById('submitBtn').style.display = 'inline-block';
    fetchHQOptions();
  }
}
</script>
</body>
</html>
